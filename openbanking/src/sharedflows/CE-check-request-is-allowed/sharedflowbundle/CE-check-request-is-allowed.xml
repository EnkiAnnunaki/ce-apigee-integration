<SharedFlowBundle revision="3" name="CE-check-request-is-allowed">
    <DisplayName>CE-check-request-is-allowed</DisplayName>
    <Description>Check whether an access token has sufficient permissions to execute a request, based on token validity and consent associated to the token</Description>
    <CreatedAt>1666585929348</CreatedAt>
    <LastModifiedAt>1666585929348</LastModifiedAt>
    <Policies>
        <Policy>JS-checkScopeIsSufficient</Policy>
        <Policy>FC-get-jwks</Policy>
        <Policy>RF-InvalidConsent</Policy>
        <Policy>RF-InvalidToken</Policy>
        <Policy>RF-InsufficientScope</Policy>
        <Policy>JS-CheckAccountIsIncludedInConsent</Policy>
        <Policy>EV-ExtractTokenFromAuthHdr</Policy>
        <Policy>JWT-Verify-Token</Policy>
        <Policy>KVM-GetConsentManagementCliendIdAndSecret</Policy>
        <Policy>RF-AccountNotAuthorised</Policy>
        <Policy>LC-GetConsentAssociatedWithToken</Policy>
        <Policy>KVM-RetrieveConsentInfo</Policy>
        <Policy>EV-ParseConsentInfoStructFromKVM</Policy>
        <Policy>FC-IntrospectTokenIfNotSeenBeforeOrInfoNotUpToDate</Policy>
    </Policies>
    <Resources>
        <Resource>jsc://checkAccountIsIncludedInConsent.js</Resource>
        <Resource>jsc://checkScopeIsSufficient.js</Resource>
    </Resources>
    <SharedFlows>
        <SharedFlow>default</SharedFlow>
    </SharedFlows>
    <subType>SharedFlow</subType>
</SharedFlowBundle>